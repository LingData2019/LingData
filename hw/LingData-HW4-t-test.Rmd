---
title: "HW4_t-test"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Frequent words, their acoustic duration and co-articulation effects

Many studies report shorter acoustic durations, more co-articulation and reduced articulatory targets for frequent words. The study of [Fabian Tomaschek et al.](https://www.semanticscholar.org/paper/Practice-makes-perfect-%3A-The-consequences-of-for-Tomaschek-Tucker/1e0dbc3787a6da84ffd4c3cae62f1340e4267694) (2018) investigates a factor ignored in discussions on the relation between frequency and phonetic detail, namely, that motor skills improve with experience.  
Twenty-seven German verbs with the vowel [a:] in the stem were used. All verbs were presented in a _sie ..._ phrase which is disyllabic in its canonical form (e.g., [zi:tsa:lən]). Nine of these verbs were also presented in a phrase eliciting a monosyllabic verb form ([i:ɐtsa:lt]). Verbs were selected to cover a wide range of relative frequencies according to written and spoken corpus data.  
Values:  
* LogDurationA - log-trasformed word duration  
* LogDurationW - log-transformed segment duration  
* Lemma  
* Participant - participant ID  
* Cond - condition (slow, fast)  
* Exponent - inflectional exponent of verbs: -t, -en, -n. By default: t  
* Frequency - log-transformed frequency in the corpus  

### 1.1

Load data and look at the summary

```{r data}
dat <- read.csv('http://math-info.hse.ru/f/2018-19/ling-data/dur_word_frequency.csv')
summary(dat)
```

### 1.1 Word duration and segment duration

Create two boxplots to see the distribution of word duration and segment duration values.

```{r}
boxplot(dat$LogDurationA, dat$LogDurationW, names = c("LogDurationA", "LogDurationW"))
```

### 1.2 Word duration and segment duration in slow and fast condition

Group the data by condition and estimate if there is a difference in the word duration with the help of boxplot. Do the same for the segment duration.

```{r}
boxplot(dat$LogDurationA ~ dat$Cond)
boxplot(dat$LogDurationW ~ dat$Cond)
```

### 2.1 t-test

Compare if the means are significantly different between (a) word durarion in fast condition and word duration in slow condition,
(b) segment durarion in fast condition and segment duration in slow condition.

```{r}
t.test(dat$LogDurationA ~ dat$Cond)
t.test(dat$LogDurationW ~ dat$Cond)
```

### Summary in a dplyr style

```{r message=FALSE}
require(tidyverse)
```

Group you data by exponent and condition and calculate mean, median, and standard deviation.

```{r}
dat %>% 
  group_by(Cond, Exponent) %>%
  summarise(mean = mean(LogDurationW),
            median = median(LogDurationW),
            st.dev = sd(LogDurationW))
```

### 3.1 Density plots

Use ggplot() to create a density plot for LogDurationW in slow and fast condition.

```{r}
dat %>% 
  ggplot(aes(LogDurationW, fill = Cond, color = Cond))+
  geom_density(alpha = 0.4)+
  geom_rug()+
  labs(title = "Segment duration density plot",
       caption = "Data from (Tomaschek et al.)",
       x = "LogDurationW")
```

### 3.2 Density plot by speaker

Create the same density plots for each speaker using facet_wrap() in ggplot().

```{r}
dat %>% 
  ggplot(aes(LogDurationW, fill = Cond, color = Cond))+
  geom_density(alpha = 0.4)+
  geom_rug()+
  facet_wrap(~ Exponent)+
  labs(title = "Segment duration density plot by exponent",
       caption = "Data from (Tomaschek et al. 2018)",
       x = "LogDurationW")
```

